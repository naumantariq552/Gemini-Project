<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gemini Chat — Pro UI</title>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
  <style>
    :root {
      --bg-grad-1: #2c3e50;
      --bg-grad-2: #3498db;
      --card-radius: 1.25rem;
    }

    body {
      min-height: 100vh;
      background: linear-gradient(135deg, var(--bg-grad-1), var(--bg-grad-2));
      background-attachment: fixed;
      display: flex;
      flex-direction: column;
    }

    .navbar-brand {
      font-weight: 700;
      letter-spacing: 0.3px;
    }

    .chat-wrapper {
      flex: 1 0 auto;
      display: grid;
      place-items: center;
      padding: 1rem;
    }

    .chat-card {
      width: min(100%, 900px);
      height: min(88vh, 860px);
      border: none;
      border-radius: var(--card-radius);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.18);
      overflow: hidden;
      backdrop-filter: blur(6px);
      animation: floatIn 600ms ease-in-out;
    }

    @keyframes floatIn {
      from { transform: translateY(12px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .chat-header {
      background: linear-gradient(135deg, #3498db, #2c3e50);
      color: #fff;
    }

    .chat-body {
      background: #f7f9fc;
      overflow-y: auto;
      padding: 1.25rem;
    }

    .msg {
      max-width: 80%;
      border-radius: 1rem;
      padding: .75rem .9rem;
      margin: 0.35rem 0;
      display: inline-block;
      position: relative;
      animation: pop .2s ease;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    @keyframes pop { from{ transform: scale(.98); opacity:.5 } to{ transform: scale(1); opacity:1 } }

    .msg-user {
      background: #3498db;
      color: #fff;
      border-bottom-right-radius: .4rem;
      align-self: end;
    }
    .msg-bot {
      background: #e9eef7;
      color: #0c1b2a;
      border-bottom-left-radius: .4rem;
      align-self: start;
    }
    .msg-time { font-size: .72rem; opacity: .7; display:block; margin-top: .2rem; }

    .bubble {
      display: flex;
      gap: .5rem;
      align-items: flex-end;
    }

    .avatar {
      width: 34px; height: 34px; border-radius: 50%; display: grid; place-items: center;
    }
    .avatar-user { background: #3498db; color:#fff; }
    .avatar-bot { background: #212529; color:#fff; }

    .chat-input {
      background: #fff;
      border-top: 1px solid rgba(0,0,0,.06);
      padding: .75rem;
    }

    .input-group .form-control {
      border-radius: .9rem 0 0 .9rem;
      padding: .9rem 1rem;
    }
    .input-group .btn-send {
      border-radius: 0 .9rem .9rem 0;
      padding: .9rem 1.1rem;
    }

    .typing { display: inline-flex; gap: 4px; align-items: center; }
    .dot { width: 6px; height: 6px; background:#6c757d; border-radius: 50%; animation: blink 1.2s infinite; }
    .dot:nth-child(2){ animation-delay: .2s }
    .dot:nth-child(3){ animation-delay: .4s }
    @keyframes blink { 0%,80%,100% { opacity:.2 } 40%{ opacity:1 } }

    footer { flex-shrink: 0; }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark sticky-top shadow-sm" style="background: linear-gradient(135deg,#2c3e50,#3498db);">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="#">
        <i class="bi bi-stars me-2"></i>
        Gemini Chat
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navContent" aria-controls="navContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navContent">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link active" href="#">Chat</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Chat -->
  <main class="chat-wrapper">
    <div class="card chat-card">
      <div class="card-header chat-header">
        <div class="d-flex align-items-center justify-content-between">
          <div class="d-flex align-items-center gap-2 text-white">
            <i class="bi bi-robot"></i>
            <span class="fw-semibold">Gemini Assistant</span>
          </div>
        </div>
      </div>

      <div id="chatBody" class="card-body chat-body d-flex flex-column">
        <div class="d-flex align-items-end gap-2 mb-1">
          <div class="avatar avatar-bot"><i class="bi bi-robot"></i></div>
          <div class="msg msg-bot">
            Hi! I\'m your Gemini-powered assistant. Ask me anything ✨
            <span class="msg-time">Now</span>
          </div>
        </div>
      </div>

      <div class="chat-input">
        <form id="chatForm" class="input-group">
          <input id="prompt" type="text" class="form-control" placeholder="Type your message and press Enter..." autocomplete="off" />
          <button id="sendBtn" class="btn btn-primary btn-send" type="submit">
            <span class="d-none d-sm-inline">Send</span>
            <i class="bi bi-send d-sm-none"></i>
          </button>
        </form>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-dark text-white-50 py-3 mt-auto">
    <div class="container small d-flex flex-column flex-sm-row justify-content-between align-items-center gap-2">
      <div>
        <i class="bi bi-c-circle"></i> <span id="year"></span> • Powered by <strong>Nauman Tariq</strong>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Gemini Logic -->
  <script type="module">
    import { GoogleGenerativeAI } from 'https://esm.run/@google/generative-ai';
    const API_KEY = 'AIzaSyCuinHh3Biiuu_jDDyVVJq6frCGG2yjWSA';
    const MODEL_NAME = 'gemini-2.0-flash';
    const genAI = new GoogleGenerativeAI(API_KEY);
    const model = genAI.getGenerativeModel({ model: MODEL_NAME });

    const chatBody = document.getElementById('chatBody');
    const chatForm = document.getElementById('chatForm');
    const prompt = document.getElementById('prompt');
    const sendBtn = document.getElementById('sendBtn');
    document.getElementById('year').textContent = new Date().getFullYear();

    function timeNow() {
      const d = new Date();
      return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }

    function addMessage(text, who = 'bot') {
      const row = document.createElement('div');
      row.className = 'd-flex align-items-end gap-2';
      if (who === 'user') row.classList.add('justify-content-end');
      const avatar = document.createElement('div');
      avatar.className = `avatar ${who === 'user' ? 'avatar-user' : 'avatar-bot'}`;
      avatar.innerHTML = who === 'user' ? '<i class="bi bi-person"></i>' : '<i class="bi bi-robot"></i>';
      const bubble = document.createElement('div');
      bubble.className = `msg ${who === 'user' ? 'msg-user' : 'msg-bot'}`;
      bubble.textContent = text;
      const time = document.createElement('span');
      time.className = 'msg-time';
      time.textContent = timeNow();
      bubble.appendChild(time);
      if (who === 'user') {
        row.appendChild(bubble); row.appendChild(avatar);
      } else {
        row.appendChild(avatar); row.appendChild(bubble);
      }
      chatBody.appendChild(row);
      chatBody.scrollTop = chatBody.scrollHeight;
      return bubble;
    }

    function showTyping() {
      const row = document.createElement('div');
      row.className = 'd-flex align-items-end gap-2';
      const avatar = document.createElement('div');
      avatar.className = 'avatar avatar-bot';
      avatar.innerHTML = '<i class="bi bi-robot"></i>';
      const bubble = document.createElement('div');
      bubble.className = 'msg msg-bot';
      bubble.innerHTML = '<span class="typing"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span>';
      row.appendChild(avatar); row.appendChild(bubble);
      chatBody.appendChild(row);
      chatBody.scrollTop = chatBody.scrollHeight;
      return { row, bubble };
    }

    async function typeOut(element, text) {
      element.textContent = '';
      for (let i = 0; i < text.length; i++) {
        element.textContent += text[i];
        chatBody.scrollTop = chatBody.scrollHeight;
        await new Promise(r => setTimeout(r, 8));
      }
      const time = document.createElement('span');
      time.className = 'msg-time';
      time.textContent = timeNow();
      element.appendChild(time);
    }

    chatForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const text = prompt.value.trim();
      if (!text) return;
      addMessage(text, 'user');
      prompt.value = ''; prompt.focus();
      sendBtn.disabled = true;
      const typing = showTyping();
      try {
        const result = await model.generateContent(text);
        let reply = result?.response?.candidates?.[0]?.content?.parts?.map(p => p.text || '').join('')
          || result?.response?.text?.() || '…';
        typing.row.remove();
        const bubble = addMessage('', 'bot');
        await typeOut(bubble, reply);
      } catch (err) {
        typing.row.remove();
        addMessage(`⚠️ Error: ${err.message}`, 'bot');
      } finally {
        sendBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
